/* ========== MOBILE SPECIFIC STYLES ========== */

/* Force landscape mode for mobile */
@media (max-width: 768px) {
    .orientation-warning {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 20000;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        color: white;
        text-align: center;
        padding: 20px;
    }

    .orientation-warning i {
        font-size: 4rem;
        margin-bottom: 20px;
        color: #FFD700;
        animation: rotate 2s infinite linear;
    }

    @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    .orientation-warning h2 {
        font-size: 1.8rem;
        margin-bottom: 15px;
    }

    .orientation-warning p {
        font-size: 1.2rem;
        line-height: 1.5;
        max-width: 80%;
    }
    
    .container, .main-menu, .winner-popup {
        display: none;
    }
    
    /* Show container only in landscape mode */
    @media (orientation: landscape) {
        .orientation-warning {
            display: none;
        }
        
        .container, .main-menu:not(.hidden), .winner-popup.active {
            display: flex;
        }
        
        /* ✅ OPTIMIZATION: Container full width dan height untuk mobile */
        .container {
            max-width: 100%;
            width: 100%;
            margin: 0;
            border-radius: 0;
            height: 100vh;
        }
        
        /* ✅ OPTIMIZATION: Game area lebih optimal dengan height fix */
        .game-area {
            gap: 5px;
            padding: 5px;
            flex: 1; /* ✅ PASTIKAN: mengambil semua space tersisa */
            min-height: 0; /* ✅ PENTING: allow shrinking */
            height: 100%; /* ✅ TAMBAHKAN: full height */
            overflow: hidden; /* ✅ TAMBAHKAN: prevent overflow */
        }
        
        /* ✅ OPTIMIZATION: Player panel lebih kompak dengan height fix */
        .player-panel {
            min-width: unset;
            max-width: unset;
            padding: 8px;
            min-height: 0; /* ✅ PENTING: allow shrinking */
            height: 100%; /* ✅ TAMBAHKAN: full height */
            overflow: hidden; /* ✅ TAMBAHKAN: prevent overflow */
        }
        
        /* ✅ OPTIMIZATION: Tug of war arena lebih proporsional dengan height fix */
        .tug-of-war-arena {
            min-width: unset;
            flex: 1.5;
            min-height: 0; /* ✅ PENTING: allow shrinking */
            height: 100%; /* ✅ TAMBAHKAN: full height */
        }

        /* ✅ OPTIMIZATION: Header lebih kompak */
        header {
            padding: 8px 12px;
            border-radius: 0;
            flex-shrink: 0; /* ✅ JANGAN shrink */
        }

        .main-title {
            font-size: 1.5rem;
        }

        .sub-title {
            font-size: 0.8rem;
        }

        /* ✅ OPTIMIZATION: Problem display lebih kecil */
        .problem-display {
            font-size: 1rem;
            padding: 8px;
            min-height: 40px;
            flex-shrink: 0; /* ✅ JANGAN shrink */
        }

        /* ✅ OPTIMIZATION: Answer display lebih kecil */
        .answer-display {
            height: 35px;
            font-size: 1.1rem;
            margin-bottom: 8px;
            flex-shrink: 0; /* ✅ JANGAN shrink */
        }

        /* ✅ OPTIMIZATION: Keypad lebih kompak dengan height fix */
        .keypad {
            gap: 3px;
            flex: 1; /* ✅ PASTIKAN: keypad mengambil sisa space */
            min-height: 0; /* ✅ PENTING: allow shrinking */
            overflow: hidden;
        }

        .keypad button {
            padding: 6px;
            font-size: 0.9rem;
            min-height: 35px;
        }

        /* ✅ OPTIMIZATION: Player header lebih kecil */
        .player-header {
            padding: 6px;
            font-size: 0.9rem;
            margin: -8px -8px 8px -8px;
            flex-shrink: 0; /* ✅ JANGAN shrink */
        }

        /* ✅ OPTIMIZATION: Feedback box */
        .feedback-box {
            flex-shrink: 0; /* ✅ JANGAN shrink */
            height: 30px;
            line-height: 30px;
            font-size: 1rem;
            margin-top: 8px;
        }

        /* ✅ OPTIMIZATION: Game controls */
        .game-controls {
            flex-shrink: 0; /* ✅ JANGAN shrink */
            padding: 8px;
            margin: 5px;
        }

        /* ✅ OPTIMIZATION: Footer */
        footer {
            flex-shrink: 0; /* ✅ JANGAN shrink */
            padding: 6px;
            border-radius: 0;
        }
    }
}

/* Mobile Landscape (Untuk perangkat dengan tinggi terbatas, e.g., max-height: 600px) */
@media (max-height: 600px) and (orientation: landscape) {
    body {
        padding: 0;
        justify-content: flex-start;
        min-height: auto;
        height: 100vh;
    }
    
    .container {
        height: 100vh;
        gap: 5px;
        max-width: 100%;
        width: 100%;
        margin: 0;
        border-radius: 0;
    }
    
    header {
        padding: 8px 12px;
        border-radius: 0;
        flex-shrink: 0;
    }
    
    h1 {
        font-size: 1.2rem;
        margin-bottom: 3px;
    }
    
    .subtitle {
        font-size: 0.7rem;
        padding: 3px 8px;
        margin-bottom: 3px;
    }
    
    .game-area {
        gap: 5px;
        flex-direction: row;
        padding: 5px;
        flex: 1;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }
    
    /* PLAYER PANELS */
    .player-panel {
        padding: 8px;
        border-radius: 8px;
        min-width: unset;
        max-width: unset;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }
    
    .player-title {
        font-size: 0.8rem;
        padding: 4px;
        margin-bottom: 6px;
        flex-shrink: 0;
    }
    
    .player-grid {
        gap: 3px;
        grid-template-columns: repeat(6, 1fr); 
        grid-template-rows: repeat(5, 1fr);
        padding: 3px;
        flex: 1;
        min-height: 0;
    }
    
    .tile {
        font-size: 0.8rem;
        border-radius: 6px;
    }
    
    /* CENTER PANEL */
    .center-panel {
        width: 120px;
        padding: 8px;
        border-radius: 8px;
        position: relative;
        min-height: 0;
        height: 100%;
    }

    /* TUG OF WAR ARENA */
    .tug-of-war-arena {
        position: relative; 
        height: 100%;
        width: 100%;
        min-width: unset;
        flex: 1.5;
        min-height: 0;
    }
    
    /* TIMER CONTAINER */
    .timer-container {
        position: absolute !important;
        top: 5px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        z-index: 200 !important;
        margin: 0 !important;
        padding: 3px 6px !important;
        min-height: auto;
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 3px;
        background: rgba(0, 0, 0, 0.9);
        border-radius: 6px;
        min-width: 110px;
        flex-shrink: 0;
    }
    
    .timer-label {
        display: inline !important;
        font-size: 0.6em;
        margin-bottom: 0;
    }
    
    .timer-display {
        font-size: 0.8em;
    }
    
    /* ILLUSTRATION OPTIMIZATION */
    .tug-of-war-illustration {
        height: 30%;
        top: 50%;
    }

    /* SCORE DISPLAY */
    .arena-score-display {
        padding: 6px 15px;
        gap: 30px;
        bottom: 10px;
        flex-shrink: 0;
    }

    .score-value {
        font-size: 1.2rem;
        padding: 1px 6px;
    }

    .score-label {
        font-size: 0.8rem;
    }

    /* KEYPAD OPTIMIZATION */
    .keypad {
        flex: 1;
        min-height: 0;
        gap: 3px;
    }

    .keypad button {
        padding: 5px;
        font-size: 0.8rem;
        min-height: 30px;
    }

    /* GAME CONTROLS */
    .game-controls {
        padding: 8px;
        margin: 5px;
        flex-shrink: 0;
    }

    #status-message {
        font-size: 0.9rem;
        margin-bottom: 8px;
    }

    .btn {
        padding: 5px 10px;
        font-size: 0.8rem;
    }
    
    footer {
        padding: 6px;
        border-radius: 0;
        flex-shrink: 0;
    }

    .social-links a {
        padding: 4px 8px;
        font-size: 0.7rem;
    }
}

/* Mobile Portrait - Hide game content */
@media (max-width: 768px) and (orientation: portrait) {
    .container, .main-menu, .winner-popup {
        display: none;
    }
    
    .orientation-warning {
        display: flex;
    }
}

/* Small Mobile Screens */
@media (max-width: 480px) and (orientation: landscape) {
    .container {
        height: 100vh;
        max-width: 100%;
        width: 100%;
        margin: 0;
    }
    
    header {
        padding: 10px;
        border-radius: 0;
        flex-shrink: 0;
    }
    
    .player-panel {
        padding: 6px;
        min-width: unset;
        max-width: unset;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }
    
    .center-panel {
        padding: 6px;
        width: 100px;
        min-height: 0;
        height: 100%;
    }
    
    .player-grid {
        gap: 2px;
        grid-template-columns: repeat(6, 1fr); 
        grid-template-rows: repeat(5, 1fr);
        padding: 2px;
        flex: 1;
        min-height: 0;
    }
    
    .tile {
        font-size: clamp(0.7rem, 2vw, 1rem);
    }
    
    /* Optimasi tambahan untuk very small mobile */
    .game-area {
        gap: 3px;
        padding: 3px;
        flex: 1;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }
    
    .problem-display {
        font-size: 0.9rem;
        padding: 8px;
        min-height: 40px;
        flex-shrink: 0;
    }

    .answer-display {
        height: 30px;
        font-size: 1rem;
        flex-shrink: 0;
    }
    
    .keypad {
        flex: 1;
        min-height: 0;
        gap: 2px;
    }

    .keypad button {
        padding: 6px;
        font-size: 0.9rem;
        min-height: 35px;
    }

    .player-header {
        padding: 4px;
        font-size: 0.8rem;
        margin: -6px -6px 6px -6px;
        flex-shrink: 0;
    }

    .timer-container {
        padding: 2px 4px !important;
        min-width: 100px;
        flex-shrink: 0;
    }

    .timer-display {
        font-size: 0.7em;
    }

    .arena-score-display {
        padding: 4px 12px;
        gap: 25px;
        flex-shrink: 0;
    }

    .score-value {
        font-size: 1.1rem;
    }

    .game-controls {
        padding: 6px;
        margin: 3px;
        flex-shrink: 0;
    }

    footer {
        padding: 4px;
        flex-shrink: 0;
    }
}

/* Very Small Mobile Screens */
@media (max-width: 360px) and (orientation: landscape) {
    .container {
        height: 100vh;
    }
    
    .player-panel {
        padding: 4px;
        min-height: 0;
        height: 100%;
    }
    
    .center-panel {
        width: 90px;
        padding: 4px;
        min-height: 0;
        height: 100%;
    }
    
    .player-title {
        font-size: 0.7rem;
        padding: 3px;
        flex-shrink: 0;
    }
    
    .tile {
        font-size: 0.7rem;
    }
    
    .problem-display {
        font-size: 0.8rem;
        padding: 6px;
        min-height: 35px;
        flex-shrink: 0;
    }

    .answer-display {
        height: 28px;
        font-size: 0.9rem;
        flex-shrink: 0;
    }
    
    .keypad {
        flex: 1;
        min-height: 0;
        gap: 1px;
    }

    .keypad button {
        padding: 4px;
        font-size: 0.8rem;
        min-height: 30px;
    }

    .player-header {
        font-size: 0.7rem;
        padding: 3px;
        flex-shrink: 0;
    }

    .timer-container {
        min-width: 90px;
        padding: 1px 3px !important;
        flex-shrink: 0;
    }

    .timer-label {
        font-size: 0.5em;
    }

    .timer-display {
        font-size: 0.6em;
    }

    .arena-score-display {
        padding: 3px 10px;
        gap: 20px;
        bottom: 5px;
        flex-shrink: 0;
    }

    .score-value {
        font-size: 1rem;
    }

    .score-label {
        font-size: 0.7rem;
    }

    .game-controls {
        padding: 5px;
        margin: 2px;
        flex-shrink: 0;
    }

    #status-message {
        font-size: 0.8rem;
    }

    .btn {
        padding: 4px 8px;
        font-size: 0.7rem;
    }

    footer {
        padding: 3px;
        flex-shrink: 0;
    }

    .social-links a {
        padding: 2px 4px;
        font-size: 0.6rem;
    }
}

/* Tablet Landscape */
@media (min-width: 769px) and (max-width: 1024px) and (orientation: landscape) {
    .container {
        max-width: 100%;
        margin: 0;
        height: 100vh;
    }

    .game-area {
        gap: 10px;
        padding: 10px;
        flex: 1;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }

    .player-panel {
        min-width: 280px;
        max-width: 350px;
        min-height: 0;
        height: 100%;
        overflow: hidden;
    }

    .tug-of-war-arena {
        min-width: 400px;
        flex: 2;
        min-height: 0;
        height: 100%;
    }

    .keypad {
        flex: 1;
        min-height: 0;
    }
}

/* Untuk menyembunyikan kartu yang cocok tanpa mengubah tata letak */
.tile.is-hidden {
    visibility: hidden;
    pointer-events: none;
}

/* ✅ FIX UNTUK POPUP PEMENANG DI MOBILE */
@media (max-width: 768px) {
    .winner-popup.active {
        display: flex !important;
        z-index: 10000 !important;
    }

    .winner-content {
        max-width: 90vw;
        max-height: 80vh;
        padding: 20px;
        margin: 10px;
    }

    .winner-title {
        font-size: 1.5rem;
    }

    .winner-message {
        font-size: 2rem;
    }

    .winner-scores {
        flex-direction: column;
        gap: 15px;
    }

    .player-score {
        min-width: 120px;
        padding: 15px;
    }

    .player-score-value {
        font-size: 2rem;
    }

    .popup-actions {
        flex-direction: column;
        gap: 10px;
    }

    .btn {
        width: 100%;
    }
}
